Еще одна машина уровня easy. Машина, которая максимально помогает нам с решением.
Так что давайте отвечать на вопросы.

Просканируем сервис и посмотрим какие порты открыты
`rustscan -a <ip>`

![](../src/images/Pasted%20image%2020250518140047.png)

Т.к. доступен 80 порт(http), то можно погулять по веб-морде и посмотреть что там есть.

посмотрим, какие есть адреса:

/data/19
/ip
/netstat

/data/19 - 19 - вероятно всего какой-то id. Это значение, которое инкрементируется. Если будут доступны другие значения, которые не должны быть доступны нам, то это idor.

```
IDOR (Insecure Direct Object Reference, небезопасные прямые ссылки на объекты) — это уязвимость, которая позволяет получить несанкционированный доступ к веб-страницам или файлам.
```

/ip - вывод команды if config

/netstat - вывод команды netstat.  можно подумать что здесь имеется инъекция команд, но скорее всего это только название страницы.  

Как раз следующий вопрос нам намекает на наличие IDOR

**After running a "Security Snapshot", the browser is redirected to a path of the format `/[something]/[id]`, where `[id]` represents the id number of the scan. What is the `[something]`?**
- data

Для проверки наличия IDOR, попробуем менять id в порядке уменьшения. 
/data/0 - выдает страницу, на которой есть кнопка download.

**Are you able to get to other users' scans?**
 - yes

**What is the ID of the PCAP file that contains sensative data?
- 0

![](../src/images/Pasted%20image%2020250507005235.png)

Скачиваем файл, файл расширения .pcap, это файл, который содержит пакетные данные в сети, а значит можем открыть его с помощью wireshark.

Немного исследуем дамп и находим следующую запись. Думаю, пояснения не нужны, так что идем авторизовываться в FTP.
![](../src/images/Pasted%20image%2020250507010636.png)

`ftp nathan@10.10.10.245` Вводим пароль(Buck3tH4TF0RM3!), успех! 
Дальше достаем текст из файла user.txt
![](../src/images/Pasted%20image%2020250507013948.png)

Этот же пароль подходит и для ssh
![](../src/images/Pasted%20image%2020250507014113.png)

**Submit the flag located in the nathan user's home directory.**
- 41518ae6ff5a488fba0b0f997f3c2a94

Для того, чтобы достать флаг из root.txt, нам придется повысить привилегии.
Попробуем найти файлы SUID (Set User ID) — это бит в правах доступа файла. Когда он установлен, любой пользователь, запустивший этот файл, выполняет его от имени владельца файла (часто — root), а не от своего имени.

`getcap -r / 2>/dev/null`

Поясню что это за команда: 
1. `getcap` —Она выводит список файлов, у которых установлены определённые возможности, например, возможность открывать порты или управлять сетевыми интерфейсами.
    
2. `-r /` — опция `-r` означает "рекурсивный поиск".  
    Она заставляет `getcap` пройти по всей файловой системе, начиная с корня `/`, и проверить все файлы на наличие установленных capabilities.
    
3. `/` — это начальная точка поиска — корень всей файловой системы.

4. `2>/dev/null` — перенаправление стандартных ошибок (stderr) в `/dev/null`.  

Таким образом узнали что `/usr/bin/python3.8` будет запускать из под рута. Это и есть ответ на вопрос:

**What is the full path to the binary on this machine has special capabilities that can be abused to obtain root privileges?**
- `/usr/bin/python3.8`

Откроем nano и напишем следующий скрипт:

```
import os

os.setuid(0)
os.system("/bin/bash")
```

Выполним данный скрипт и проверим права, теперь мы root:

![](../src/images/Pasted%20image%2020250518124409.png)

Остается прочитать файл /root/root.txt и забрать флаг.